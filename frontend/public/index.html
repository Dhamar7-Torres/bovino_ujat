<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <!-- Configuración básica del documento -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <!-- Información principal de la aplicación -->
  <title>Sistema de Gestión de Bovinos - Tecnología para Ganaderos</title>
  <meta name="description" content="Sistema integral para la gestión de bovinos, control de salud, producción lechera, reproducción y finanzas del rancho. Tecnología avanzada para ganaderos modernos." />
  <meta name="keywords" content="gestión de bovinos, ganado, vacas, producción lechera, salud animal, reproducción bovina, finanzas ganaderas, rancho, ganadería, veterinaria, agricultura" />
  <meta name="author" content="Sistema de Gestión de Bovinos" />
  
  <!-- Configuración de idioma y región -->
  <meta name="language" content="Spanish" />
  <meta name="geo.region" content="MX" />
  <meta name="geo.country" content="Mexico" />
  
  <!-- Configuración de robots y SEO -->
  <meta name="robots" content="index, follow, max-image-preview:large" />
  <meta name="googlebot" content="index, follow" />
  <meta name="revisit-after" content="7 days" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://bovinemanagement.com/" />
  <meta property="og:title" content="Sistema de Gestión de Bovinos - Tecnología para Ganaderos" />
  <meta property="og:description" content="Gestiona tu ganado de manera inteligente con nuestro sistema integral. Control de salud, producción, reproducción y finanzas en una sola plataforma." />
  <meta property="og:image" content="/images/og-image.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Sistema de Gestión de Bovinos - Dashboard principal" />
  <meta property="og:site_name" content="Sistema de Gestión de Bovinos" />
  <meta property="og:locale" content="es_MX" />
  
  <!-- Twitter Card -->
  <meta property="twitter:card" content="summary_large_image" />
  <meta property="twitter:url" content="https://bovinemanagement.com/" />
  <meta property="twitter:title" content="Sistema de Gestión de Bovinos - Tecnología para Ganaderos" />
  <meta property="twitter:description" content="Gestiona tu ganado de manera inteligente con nuestro sistema integral. Control de salud, producción, reproducción y finanzas en una sola plataforma." />
  <meta property="twitter:image" content="/images/twitter-card.jpg" />
  <meta property="twitter:image:alt" content="Sistema de Gestión de Bovinos - Interfaz moderna" />
  
  <!-- Configuración PWA y Mobile -->
  <meta name="application-name" content="Gestión Bovinos" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Gestión Bovinos" />
  <meta name="mobile-web-app-capable" content="yes" />
  <meta name="msapplication-TileColor" content="#3B82F6" />
  <meta name="msapplication-config" content="/browserconfig.xml" />
  
  <!-- Theme Colors para diferentes dispositivos -->
  <meta name="theme-color" content="#3B82F6" />
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#3B82F6" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1E40AF" />
  
  <!-- Íconos y favicons -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="48x48" href="/icons/favicon-48x48.png" />
  <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-chrome-192x192.png" />
  <link rel="icon" type="image/png" sizes="512x512" href="/icons/android-chrome-512x512.png" />
  
  <!-- Apple Touch Icons -->
  <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png" />
  <link rel="apple-touch-icon" sizes="57x57" href="/icons/apple-touch-icon-57x57.png" />
  <link rel="apple-touch-icon" sizes="60x60" href="/icons/apple-touch-icon-60x60.png" />
  <link rel="apple-touch-icon" sizes="72x72" href="/icons/apple-touch-icon-72x72.png" />
  <link rel="apple-touch-icon" sizes="76x76" href="/icons/apple-touch-icon-76x76.png" />
  <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114x114.png" />
  <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="144x144" href="/icons/apple-touch-icon-144x144.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180x180.png" />
  
  <!-- Manifest PWA -->
  <link rel="manifest" href="/manifest.json" />
  
  <!-- Preconexiones DNS para optimización -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link rel="preconnect" href="https://api.bovinemanagement.com" />
  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  
  <!-- Precargar recursos críticos -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" /></noscript>
  
  <!-- Leaflet CSS para mapas -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  
  <!-- Configuración de seguridad -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://unpkg.com https://cdnjs.cloudflare.com https://cdn.spline.design;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://unpkg.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: blob: https://*.openstreetmap.org https://unpkg.com;
    connect-src 'self' https://api.openweathermap.org ws://localhost:* http://localhost:*;
    media-src 'self';
    object-src 'none';
    frame-src 'self' https://my.spline.design;
  " />
  
  <!-- Esquema de datos estructurados -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Sistema de Gestión de Bovinos",
    "description": "Sistema integral para la gestión de ganado bovino con control de salud, producción y ubicación.",
    "applicationCategory": "BusinessApplication",
    "operatingSystem": "Web Browser",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "MXN"
    },
    "creator": {
      "@type": "Organization",
      "name": "Bovine Management Systems"
    }
  }
  </script>
  
  <!-- Configuración inicial de tema -->
  <script>
    // Aplicar tema antes de que se cargue la página para evitar flash
    (function() {
      try {
        const savedTheme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const shouldUseDark = savedTheme === 'dark' || (!savedTheme && prefersDark);
        
        if (shouldUseDark) {
          document.documentElement.classList.add('dark');
        }
      } catch (e) {
        console.warn('Error al aplicar tema:', e);
      }
    })();
  </script>
  
  <!-- CSS inline crítico para evitar FOUC -->
  <style>
    /* CSS crítico para cargar rápido */
    html, body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      line-height: 1.6;
    }
    
    body {
      background-color: #f9fafb;
      color: #111827;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    
    .dark body {
      background-color: #111827;
      color: #f9fafb;
    }
    
    /* Loading inicial */
    #root {
      min-height: 100vh;
    }
    
    .initial-loading {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    .loading-text {
      color: white;
      margin-top: 20px;
      font-size: 18px;
      font-weight: 500;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Ocultar el loader cuando React esté listo */
    .react-loaded .initial-loading {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease;
    }
    
    /* Prevent FOUC */
    .no-js #root {
      display: none;
    }
    
    /* Critical CSS para botones */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
      border: none;
      font-weight: 500;
      transition: all 0.2s ease;
      cursor: pointer;
    }
    
    .btn-primary {
      background-color: #3b82f6;
      color: white;
      padding: 0.5rem 1rem;
    }
    
    .btn-primary:hover {
      background-color: #2563eb;
    }
  </style>
</head>

<body class="h-full antialiased">
  <!-- Loader inicial mientras carga React -->
  <div id="initial-loader" class="initial-loading">
    <div class="flex flex-col items-center">
      <div class="loading-spinner"></div>
      <p class="loading-text">Cargando Sistema de Gestión de Bovinos...</p>
    </div>
  </div>
  
  <!-- Contenedor principal de la aplicación React -->
  <div id="root" class="h-full"></div>
  
  <!-- Fallback para usuarios sin JavaScript -->
  <noscript>
    <div style="padding: 2rem; text-align: center; background: #fef2f2; border: 1px solid #fca5a5; border-radius: 0.5rem; margin: 2rem;">
      <h2 style="color: #dc2626; margin-bottom: 1rem;">JavaScript Requerido</h2>
      <p style="color: #7f1d1d; line-height: 1.6;">
        Para utilizar el Sistema de Gestión de Bovinos, necesitas habilitar JavaScript en tu navegador.
        Esta aplicación requiere JavaScript para funcionar correctamente.
      </p>
      <p style="color: #7f1d1d; margin-top: 1rem;">
        <strong>Cómo habilitar JavaScript:</strong><br>
        • Chrome: Configuración → Privacidad y seguridad → Configuración del sitio → JavaScript<br>
        • Firefox: about:config → javascript.enabled → true<br>
        • Safari: Preferencias → Seguridad → Habilitar JavaScript
      </p>
    </div>
  </noscript>
  
  <!-- Script principal de la aplicación React/Vite -->
  <script type="module" src="/src/main.jsx"></script>
  
  <!-- Script para ocultar el loader cuando React esté listo -->
  <script>
    // Ocultar loader cuando React se haya montado
    document.addEventListener('DOMContentLoaded', function() {
      // Verificar periódicamente si React se ha cargado
      const checkReactLoaded = setInterval(function() {
        const root = document.getElementById('root');
        if (root && root.children.length > 0) {
          const loader = document.getElementById('initial-loader');
          if (loader) {
            loader.style.opacity = '0';
            setTimeout(function() {
              loader.style.display = 'none';
            }, 500);
          }
          clearInterval(checkReactLoaded);
        }
      }, 100);
      
      // Fallback: ocultar loader después de 10 segundos máximo
      setTimeout(function() {
        const loader = document.getElementById('initial-loader');
        if (loader) {
          loader.style.display = 'none';
        }
        clearInterval(checkReactLoaded);
      }, 10000);
    });
    
    // Error handler global
    window.addEventListener('error', function(e) {
      console.error('Error global capturado:', e.error);
      
      // Mostrar mensaje de error amigable
      const loader = document.getElementById('initial-loader');
      if (loader) {
        loader.innerHTML = `
          <div style="text-align: center; color: white;">
            <h2>Error al cargar la aplicación</h2>
            <p>Por favor, recarga la página</p>
            <button onclick="window.location.reload()" class="btn btn-primary" style="margin-top: 1rem;">
              Recargar página
            </button>
          </div>
        `;
      }
    });
    
    // Service Worker registration (solo en producción)
    if ('serviceWorker' in navigator && location.protocol === 'https:') {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/sw.js')
          .then(function(registration) {
            console.log('SW registrado exitosamente:', registration.scope);
          })
          .catch(function(registrationError) {
            console.log('SW falló al registrarse:', registrationError);
          });
      });
    }
  </script>
  
  <!-- Analytics y tracking (solo en producción) -->
  <script>
    // Google Analytics o similar se cargaría aquí en producción
    if (location.hostname !== 'localhost' && location.hostname !== '127.0.0.1') {
      // Código de analytics aquí
    }
  </script>
</body>
</html>